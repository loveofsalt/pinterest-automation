name: Create Pinterest Pin (Base64)

on:
  workflow_dispatch:
    inputs:
      file_path:
        description: 'File Path (e.g. images/photo1.jpg)'
        required: true
        type: string
      title:
        description: 'Pin Title'
        required: true
        type: string
      description:
        description: 'Pin Description'
        required: true
        type: string
      link:
        description: 'Destination Link'
        required: true
        default: 'https://loveofsalt.com'
        type: string
      alt_text:
        description: 'Alt Text (SEO)'
        required: false
        type: string

jobs:
  post_pin:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        # This step is CRITICAL. It downloads your repo content so the script can find the image file.

      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: '1.21'

      - name: Run Pinner
        env:
          PINTEREST_APP_ID: ${{ secrets.PINTEREST_APP_ID }}
          PINTEREST_APP_SECRET: ${{ secrets.PINTEREST_APP_SECRET }}
          PINTEREST_REFRESH_TOKEN: ${{ secrets.PINTEREST_REFRESH_TOKEN }}
          PINTEREST_BOARD_ID: ${{ secrets.PINTEREST_BOARD_ID }}
          
          # Map inputs
          INPUT_FILE_PATH: ${{ inputs.file_path }}
          INPUT_TITLE: ${{ inputs.title }}
          INPUT_DESCRIPTION: ${{ inputs.description }}
          INPUT_LINK: ${{ inputs.link }}
          INPUT_ALT_TEXT: ${{ inputs.alt_text }}
        run: go run main.go